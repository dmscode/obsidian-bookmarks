# Obsidian 书签创建器插件

一个用于创建书签笔记的 Obsidian 插件，支持两种使用方式：直接输入网址使用AI自动生成书签信息，或使用YAML格式手动输入书签信息。插件可以自动生成网站截图并保存为附件。

## 功能特点

- 🚀 通过命令快速创建书签笔记
- 🤖 **AI自动生成功能**：直接输入网址，自动提取网页内容并生成完整书签信息
- 📸 自动生成网站截图
- 🏷️ 支持标签分类（支持多级分类标签）
- 📁 可自定义存储文件夹
- 🎯 自动打开创建的笔记
- 📝 支持添加备注信息
- ⏱️ 实时进度显示，了解处理状态
- 🔧 支持自定义AI提示词模板

## 安装方法

### 手动安装

1. 下载最新版本的插件文件
2. 将 `manifest.json`、`main.js` 文件复制到你的 Obsidian  vault 的 `.obsidian/plugins/bookmark-creator/` 文件夹中
3. 在 Obsidian 的设置中启用插件

### 使用 BRAT 安装

1. 安装 [BRAT 插件](https://github.com/TfTHacker/obsidian42-brat)
2. 打开命令面板（Ctrl/Cmd + P）
3. 输入 "BRAT: Add a beta plugin for testing"
4. 输入插件仓库地址：`https://github.com/dmscode/obsidian-bookmarks`
5. 等待 BRAT 下载并安装插件
6. 在 Obsidian 的设置中启用插件

### 开发模式安装

1. 克隆或下载此仓库
2. 在项目目录中运行 `npm install` 安装依赖
3. 运行 `npm run build` 构建插件
4. 将构建好的文件复制到 Obsidian vault 的插件文件夹中

## 使用方法

插件提供两种创建书签的方式：

### 方式一：直接输入网址（AI自动生成）

**推荐方式！** 只需输入网址，插件会自动：

1. 使用 Jina AI 提取网页内容
2. 搜索网站相关信息和评价
3. 使用 AI 生成完整的书签信息（标题、描述、标签）
4. 自动生成网站截图
5. 创建格式化的书签笔记

**使用步骤：**
1. 打开命令面板（Ctrl/Cmd + P）
2. 输入 "创建书签笔记" 并选择命令
3. 在对话框中直接输入网址，例如：`https://example.com/`
4. 点击 "创建书签" 按钮
5. 等待处理完成（会显示实时进度）

**前提条件：**
- 需要在插件设置中配置 Jina AI API 密钥
- 需要在插件设置中配置 AI API 密钥（支持 OpenAI、Kimi 等兼容 API）

### 方式二：YAML 格式输入

手动输入格式化的书签信息，适合有特定需求的场景。

**使用步骤：**
1. 打开命令面板（Ctrl/Cmd + P）
2. 输入 "创建书签笔记" 并选择命令
3. 在对话框中按 YAML 格式输入书签信息
4. 点击 "创建书签" 按钮

**YAML 格式说明：**
- 详细格式说明请参考 [YAML 格式使用指南](YAML_USAGE_GUIDE.md)
- 支持多级分类标签（如：`科技数码/软件下载`）
- 标签中的空格会自动替换为下划线

**示例：**
```yaml
---
created: 
title: 小众软件
url: https://www.appinn.com/
description: 专注于分享免费、小巧、实用、有趣、绿色软件的网站
tags: 
    - 科技数码/软件下载
    - 实用工具
    - 软件评测
---
```

###  AI 提示词

推荐使用 Kimi 网页版，虽然这导致无法完全自动化，但它可以读取网址并参考网络搜索来构建书签信息。可以将如下提示词保存为常用语：

``````markdown
请根据后续所给出网址指向的网站内容，以及互联网中对该网站的评价，来完善如下书签信息（标题、描述和标签），并以原格式返回，以便我直接替换输入内容。

## 细节要求：

- 其他信息完全保持原样，不要做任何修改
- 如非必要或者专有名词等，尽量使用简体中文
- 如无必要，属性值不加引号
- 生成的结果以代码块形式返回，方便复制
- 标题使用不含描述的简短标题
- 描述着重说明这是一个什么网站，包含什么，用来做什么，这种用来识别网站的关键信息
- 保持 YAML 语法正确（标签列表使用多行格式）
- 首先在下方的网站类别中选择合适的标签，标签格式为 `一级分类/二级分类`
- 对于一个网站一般只添加一次分类标签，如果确实同属于多个分类，可以适当添加，但最多两个分类标签
- 如果类别确实无法覆盖当前网站，可以适当新增类别，但请保持简洁
- 然后为网站补充具有代表性的标签，对网站进行完善标记，标签数量控制在3~7个

## 书签模板：

```markdown
---
created: 
title: 【网站名称】
url:  【网站网址】
description: 【网站描述】
tags: 
    - 【标签1】

    - 【标签2】
    - 【标签3】
---

```


## 例子：

```markdown
---
created: 2025-12-20 09:24:00
title: 小众软件
url: https://www.appinn.com/
description: 专注于分享免费、小巧、实用、有趣、绿色软件的网站，提供Windows、Mac、Android、iOS等平台的软件评测、使用体验和下载信息，发掘并推荐有价值的小众软件
tags: 
    - 软件下载
    - 软件评测
    - 技术博客
    - 免费软件
    - 实用工具
---

```

## 网站类别

- 工作学习
  - 办公软件
  - 开发工具
  - 设计资源
  - 学习平台
  - 文档资料
- 实用工具
  - 搜索引擎
  - 翻译工具
  - 文件处理
  - 系统工具
  - 安全隐私
- 科技数码
  - 产品资讯
  - 软件下载
  - 硬件信息
  - 教程攻略
- 购物消费
  - 电商平台
  - 比价工具
  - 支付服务
  - 购物攻略
- 娱乐影音
  - 视频网站
  - 音乐平台
  - 游戏娱乐
  - 阅读小说
- 新闻资讯
  - 综合新闻
  - 行业资讯
  - 本地信息
- 生活休闲
  - 旅游出行
  - 美食烹饪
  - 健康养生
  - 家居生活
- 社交社区
  - 社交平台
  - 论坛社区
  - 博客平台
- 投资理财
  - 股票基金
  - 财经资讯
  - 理财工具
- 管理维护
  - 待处理
  - 重要备份
  - 历史存档
  - 测试开发
``````

### 问 AI

将要收藏的网址丢给 AI，然后复制生成结果，进行下一步操作

### 创建书签笔记

1. 打开命令面板（Ctrl/Cmd + P）
2. 输入 "创建书签笔记" 并选择命令
3. 在弹出的对话框中按YAML格式输入书签信息：
   ```yaml
   ---
   created: 
   title: 网站标题
   url: https://example.com/
   description: 网站描述
   tags: 
       - 标签1
       - 标签2
   ---
   ```
4. 点击 "创建书签" 按钮

**注意：**
- `created` 字段如果留空，会自动填入当前时间
- `title` 和 `url` 字段为必填项
- `description` 和 `tags` 字段为可选项
- 插件会自动生成网站截图并添加到笔记中

### 插件设置

在 Obsidian 的设置页面中可以配置：

#### 基础设置
- **书签文件夹**：存储书签笔记的文件夹路径（默认：Bookmarks）
- **附件文件夹**：存储截图的文件夹路径（默认：assets/images）

#### Jina AI API 设置（用于AI自动生成功能）
- **Jina AI API密钥**：用于提取网页内容的API密钥
  - 获取方式：访问 [Jina AI 官网](https://jina.ai/) 注册获取
  - 用途：提取网页内容和搜索相关信息

#### AI处理API设置（用于生成书签信息）
- **AI API基础URL**：AI服务的API地址（默认：https://api.openai.com/v1）
  - 支持 OpenAI、Kimi 等兼容 API
- **AI API模型**：使用的AI模型名称（默认：gpt-3.5-turbo）
- **AI API密钥**：AI服务的API密钥
- **AI提示词模板**：自定义AI生成书签信息的提示词

#### 使用说明
插件支持两种输入方式：
1. **直接输入网址**：插件自动使用AI生成完整书签信息
2. **YAML格式输入**：手动输入格式化的书签信息

两种方式都会自动生成网站截图并创建笔记文件。

## 笔记格式

创建的笔记将包含以下内容：

```markdown
---
created: 2025-12-28 09:30:00
title: "网站标题"
url: "https://example.com"
description: "网站描述"
tags:
  - 标签1
  - 标签2
---

## 网站截图

screenshot:: ![网站截图](assets/images/网站标题.png)

## 网站笔记

```

**格式说明：**
- 标签使用多行列表格式，便于阅读和编辑
- 标签中的空格会自动替换为下划线
- 截图文件保存在配置的附件文件夹中（默认：`assets/images/`）
- 使用 `screenshot::` 语法便于后续处理和样式应用

## 技术细节

### 自带样式

对 Obsidian 数据库（Base）视图做了轻微优化，当视图名称为“书签”或者以“书签”开头时，会应用此样式。

### 截图生成

插件使用 [thum.io](https://thum.io) 服务生成网站截图。截图参数：
- 等待时间：12秒（确保网站完全加载）
- 视口宽度：1600px
- 截图宽度：1440px
- 裁剪高度：900px
- 格式：PNG
- 无动画：启用

截图生成过程包含重试机制，最多重试3次，每次间隔10秒。

### 文件命名

- 笔记文件：使用清理后的标题作为文件名
- 截图文件：使用清理后的标题 + `.png` 扩展名

文件名中的非法字符会被替换为下划线。

## 注意事项

1. **截图生成时间**：==由于需要等待网站加载，截图生成可能需要约半分钟的时间==
2. **网络要求**：插件需要网络连接来下载网站截图
3. **文件冲突**：如果同名文件已存在，插件会创建新文件（Obsidian 会自动添加序号）
4. **URL验证**：插件会验证输入的URL格式是否正确

## 故障排除

### 常见问题

1. **AI自动生成功能失败**
   - **Jina AI API密钥无效**：检查密钥是否正确，访问 [Jina AI 官网](https://jina.ai/) 获取有效密钥
   - **AI API密钥无效**：确认AI服务提供商的API密钥正确
   - **网络连接问题**：检查网络设置，确保可以访问外部API服务
   - **API请求频率限制**：等待一段时间后重试，或检查API配额使用情况

2. **截图下载失败**
   - 检查网络连接
   - 确认网站可以正常访问
   - 某些网站可能阻止截图服务
   - 截图服务暂时不可用：插件会自动重试3次，每次间隔10秒

3. **文件夹创建失败**
   - 检查 Obsidian vault 的写入权限
   - 确认文件夹路径设置正确
   - 确保路径中不包含非法字符

4. **插件无法启用**
   - 确认所有必需文件都已正确安装
   - 检查 Obsidian 版本是否符合要求（≥0.15.0）
   - 查看开发者控制台是否有错误信息

5. **YAML格式解析错误**
   - 检查YAML语法是否正确，特别是缩进格式
   - 确保包含必需的 `title` 和 `url` 字段
   - 参考 [YAML格式使用指南](YAML_USAGE_GUIDE.md) 中的示例

## 开发

### 项目结构

```
obsidian-bookmark-creator/
├── manifest.json          # 插件清单文件
├── main.ts               # 主插件代码
├── tsconfig.json         # TypeScript 配置
├── package.json          # 项目依赖
├── esbuild.config.mjs    # 构建配置
├── versions.json         # 版本信息
└── README.md            # 说明文档
```

### 开发命令

```bash
# 安装依赖
npm install

# 开发模式（监听文件变化）
npm run dev

# 构建生产版本
npm run build
```

## 许可证

MIT License

## 贡献

欢迎提交 Issue 和 Pull Request！

## 更新日志

### 1.3.0
- 代码结构优化和注释完善
- 添加详细的JSDoc注释
- 改进错误处理和类型定义
- 优化进度显示功能
- 增强代码可读性和维护性

### 1.0.0
- 初始版本发布
- 支持创建书签笔记
- 自动生成网站截图
- 支持标签和备注功能
- 可自定义存储文件夹
